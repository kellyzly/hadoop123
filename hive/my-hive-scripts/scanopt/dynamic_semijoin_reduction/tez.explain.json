{"STAGE DEPENDENCIES":{"Stage-1":{"ROOT STAGE":"TRUE"},"Stage-0":{"DEPENDENT STAGES":"Stage-1"}},"STAGE PLANS":{"Stage-1":{"Tez":{"DagId:":"root_20171023033632_22678fda-c28b-498c-9e2e-a5081cf9faf0:1","Edges:":{"Map 1":{"parent":"Reducer 3","type":"BROADCAST_EDGE"},"Map 5":[{"parent":"Map 1","type":"BROADCAST_EDGE"},{"parent":"Map 2","type":"BROADCAST_EDGE"},{"parent":"Map 8","type":"BROADCAST_EDGE"},{"parent":"Reducer 3","type":"BROADCAST_EDGE"}],"Map 7":{"parent":"Reducer 4","type":"BROADCAST_EDGE"},"Map 8":[{"parent":"Map 2","type":"BROADCAST_EDGE"},{"parent":"Map 7","type":"BROADCAST_EDGE"},{"parent":"Reducer 4","type":"BROADCAST_EDGE"}],"Reducer 3":{"parent":"Map 2","type":"CUSTOM_SIMPLE_EDGE"},"Reducer 4":{"parent":"Map 2","type":"CUSTOM_SIMPLE_EDGE"},"Reducer 6":{"parent":"Map 5","type":"CUSTOM_SIMPLE_EDGE"}},"DagName:":"root_20171023033632_22678fda-c28b-498c-9e2e-a5081cf9faf0:1","Vertices:":{"Map 1":{"Map Operator Tree:":[{"TableScan":{"alias:":"srcpart_date","filterExpr:":"(key is not null and (key BETWEEN DynamicValue(RS_10_srcpart_small_key1_min) AND DynamicValue(RS_10_srcpart_small_key1_max) and in_bloom_filter(key, DynamicValue(RS_10_srcpart_small_key1_bloom_filter)))) (type: boolean)","Statistics:":"Num rows: 1000 Data size: 350984 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"TS_0","children":{"Filter Operator":{"predicate:":"(key is not null and (key BETWEEN DynamicValue(RS_10_srcpart_small_key1_min) AND DynamicValue(RS_10_srcpart_small_key1_max) and in_bloom_filter(key, DynamicValue(RS_10_srcpart_small_key1_bloom_filter)))) (type: boolean)","Statistics:":"Num rows: 950 Data size: 333434 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"FIL_49","children":{"Select Operator":{"expressions:":"key (type: string)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 950 Data size: 333434 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"SEL_2","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: string)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: string)","Statistics:":"Num rows: 950 Data size: 333434 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"RS_9","outputname:":"Map 5","outputOperator:":["TS_6"]}}}}}}}}]},"Map 2":{"Map Operator Tree:":[{"TableScan":{"alias:":"srcpart_small","filterExpr:":"key1 is not null (type: boolean)","Statistics:":"Num rows: 1 Data size: 184 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"TS_3","children":{"Filter Operator":{"predicate:":"key1 is not null (type: boolean)","Statistics:":"Num rows: 1 Data size: 184 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"FIL_50","children":{"Select Operator":{"expressions:":"key1 (type: string)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 184 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"SEL_5","children":[{"Reduce Output Operator":{"key expressions:":"_col0 (type: string)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: string)","Statistics:":"Num rows: 1 Data size: 184 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"RS_10","outputname:":"Map 5","outputOperator:":["TS_6"]}},{"Select Operator":{"expressions:":"_col0 (type: string)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 184 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"SEL_55","children":{"Group By Operator":{"aggregations:":["min(_col0)","max(_col0)","bloom_filter(_col0, expectedEntries=1)"],"mode:":"hash","outputColumnNames:":["_col0","_col1","_col2"],"Statistics:":"Num rows: 1 Data size: 736 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_56","children":{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 1 Data size: 736 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: string), _col1 (type: string), _col2 (type: binary)","OperatorId:":"RS_57","outputname:":"Reducer 3","outputOperator:":["GBY_58"]}}}}}},{"Reduce Output Operator":{"key expressions:":"_col0 (type: string)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: string)","Statistics:":"Num rows: 1 Data size: 184 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"RS_24","outputname:":"Map 8","outputOperator:":["TS_20"]}},{"Select Operator":{"expressions:":"_col0 (type: string)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 184 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"SEL_73","children":{"Group By Operator":{"aggregations:":["min(_col0)","max(_col0)","bloom_filter(_col0, expectedEntries=1)"],"mode:":"hash","outputColumnNames:":["_col0","_col1","_col2"],"Statistics:":"Num rows: 1 Data size: 736 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_74","children":{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 1 Data size: 736 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: string), _col1 (type: string), _col2 (type: binary)","OperatorId:":"RS_75","outputname:":"Reducer 4","outputOperator:":["GBY_76"]}}}}}}]}}}}}}]},"Map 5":{"Map Operator Tree:":[{"TableScan":{"alias:":"alltypesorc_int","filterExpr:":"(cstring is not null and (cstring BETWEEN DynamicValue(RS_10_srcpart_small_key1_min) AND DynamicValue(RS_10_srcpart_small_key1_max) and in_bloom_filter(cstring, DynamicValue(RS_10_srcpart_small_key1_bloom_filter)))) (type: boolean)","Statistics:":"Num rows: 12288 Data size: 2148200 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"TS_6","children":{"Filter Operator":{"predicate:":"(cstring is not null and (cstring BETWEEN DynamicValue(RS_10_srcpart_small_key1_min) AND DynamicValue(RS_10_srcpart_small_key1_max) and in_bloom_filter(cstring, DynamicValue(RS_10_srcpart_small_key1_bloom_filter)))) (type: boolean)","Statistics:":"Num rows: 11674 Data size: 2040859 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"FIL_51","children":{"Select Operator":{"expressions:":"cstring (type: string)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 11674 Data size: 2040859 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"SEL_8","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"},{"":"Inner Join 1 to 2"}],"keys:":{"0":"_col0 (type: string)","1":"_col0 (type: string)","2":"_col0 (type: string)"},"input vertices:":{"0":"Map 1","1":"Map 2"},"Statistics:":"Num rows: 25682 Data size: 4489889 Basic stats: COMPLETE Column stats: NONE","HybridGraceHashJoin:":"true","OperatorId:":"MAPJOIN_91","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{},"input vertices:":{"1":"Map 8"},"Statistics:":"Num rows: 659565124 Data size: 231278223720 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"MAPJOIN_93","children":{"Group By Operator":{"aggregations:":["count()"],"mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_32","children":{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: bigint)","OperatorId:":"RS_33","outputname:":"Reducer 6","outputOperator:":["GBY_34"]}}}}}}}}}}}}}}]},"Map 7":{"Map Operator Tree:":[{"TableScan":{"alias:":"srcpart_date","filterExpr:":"(key is not null and (key BETWEEN DynamicValue(RS_24_srcpart_small_key1_min) AND DynamicValue(RS_24_srcpart_small_key1_max) and in_bloom_filter(key, DynamicValue(RS_24_srcpart_small_key1_bloom_filter)))) (type: boolean)","Statistics:":"Num rows: 1000 Data size: 174984 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"TS_14","children":{"Filter Operator":{"predicate:":"(key is not null and (key BETWEEN DynamicValue(RS_24_srcpart_small_key1_min) AND DynamicValue(RS_24_srcpart_small_key1_max) and in_bloom_filter(key, DynamicValue(RS_24_srcpart_small_key1_bloom_filter)))) (type: boolean)","Statistics:":"Num rows: 950 Data size: 166234 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"FIL_52","children":{"Select Operator":{"expressions:":"key (type: string)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 950 Data size: 166234 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"SEL_16","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: string)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: string)","Statistics:":"Num rows: 950 Data size: 166234 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"RS_23","outputname:":"Map 8","outputOperator:":["TS_20"]}}}}}}}}]},"Map 8":{"Map Operator Tree:":[{"TableScan":{"alias:":"alltypesorc_int","filterExpr:":"(cstring is not null and (cstring BETWEEN DynamicValue(RS_24_srcpart_small_key1_min) AND DynamicValue(RS_24_srcpart_small_key1_max) and in_bloom_filter(cstring, DynamicValue(RS_24_srcpart_small_key1_bloom_filter)))) (type: boolean)","Statistics:":"Num rows: 12288 Data size: 2148200 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"TS_20","children":{"Filter Operator":{"predicate:":"(cstring is not null and (cstring BETWEEN DynamicValue(RS_24_srcpart_small_key1_min) AND DynamicValue(RS_24_srcpart_small_key1_max) and in_bloom_filter(cstring, DynamicValue(RS_24_srcpart_small_key1_bloom_filter)))) (type: boolean)","Statistics:":"Num rows: 11674 Data size: 2040859 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"FIL_54","children":{"Select Operator":{"expressions:":"cstring (type: string)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 11674 Data size: 2040859 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"SEL_22","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"},{"":"Inner Join 1 to 2"}],"keys:":{"0":"_col0 (type: string)","1":"_col0 (type: string)","2":"_col0 (type: string)"},"input vertices:":{"0":"Map 7","1":"Map 2"},"Statistics:":"Num rows: 25682 Data size: 4489889 Basic stats: COMPLETE Column stats: NONE","HybridGraceHashJoin:":"true","OperatorId:":"MAPJOIN_92","children":{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 25682 Data size: 4489889 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"RS_29","outputname:":"Map 5","outputOperator:":["TS_6"]}}}}}}}}}}]},"Reducer 3":{"Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["min(VALUE._col0)","max(VALUE._col1)","bloom_filter(VALUE._col2, expectedEntries=1)"],"mode:":"final","outputColumnNames:":["_col0","_col1","_col2"],"Statistics:":"Num rows: 1 Data size: 736 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_58","children":[{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 1 Data size: 736 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: string), _col1 (type: string), _col2 (type: binary)","OperatorId:":"RS_59","outputname:":"Map 1","outputOperator:":["TS_0"]}},{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 1 Data size: 736 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: string), _col1 (type: string), _col2 (type: binary)","OperatorId:":"RS_72","outputname:":"Map 5","outputOperator:":["TS_6"]}}]}}},"Reducer 4":{"Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["min(VALUE._col0)","max(VALUE._col1)","bloom_filter(VALUE._col2, expectedEntries=1)"],"mode:":"final","outputColumnNames:":["_col0","_col1","_col2"],"Statistics:":"Num rows: 1 Data size: 736 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_76","children":[{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 1 Data size: 736 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: string), _col1 (type: string), _col2 (type: binary)","OperatorId:":"RS_77","outputname:":"Map 7","outputOperator:":["TS_14"]}},{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 1 Data size: 736 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: string), _col1 (type: string), _col2 (type: binary)","OperatorId:":"RS_90","outputname:":"Map 8","outputOperator:":["TS_20"]}}]}}},"Reducer 6":{"Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["count(VALUE._col0)"],"mode:":"mergepartial","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","OperatorId:":"GBY_34","children":{"File Output Operator":{"compressed:":"false","Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","table:":{"input format:":"org.apache.hadoop.mapred.SequenceFileInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"},"OperatorId:":"FS_36"}}}}}}}},"Stage-0":{"Fetch Operator":{"limit:":"-1","Processor Tree:":{"ListSink":{"OperatorId:":"LIST_SINK_99"}}}}}}
